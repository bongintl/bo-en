!function(){return function t(e,n,r){function i(a,u){if(!n[a]){if(!e[a]){var s="function"==typeof require&&require;if(!u&&s)return s(a,!0);if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};e[a][0].call(c.exports,function(t){var n=e[a][1][t];return i(n||t)},c,c.exports,t,e,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}}()({1:[function(t,e,n){"use strict";var r=new(window.AudioContext||window.webkitAudioContext),i=!1;e.exports={context:r,unlock:function(){if(!i){var t=r.createBuffer(1,1,22050),e=r.createBufferSource();e.buffer=t,e.start(0),i=!0}},load:function(t){return new Promise(function(e){var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=function(){return e(n.response)},n.send()}).then(function(t){return new Promise(function(e){r.decodeAudioData(t,e)})})},play:function(t,e){var n=r.createBufferSource();return n.buffer=t,n.connect(r.destination),n.start(e),n}}},{}],2:[function(t,e,n){"use strict";var r=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();var i=t("bezier-js"),o=function(t){return function(e){return[e[0]+t,e[1]]}},a=function(t,e){var n=t.map(function(t){return{point:t,connections:0}}),r=function(t,e){return e.slice().sort(function(t){return function(e){return Math.abs(t[1]-e.point[1])}}(t))[0]},i=function(t){return function(t){return r(t,n.filter(function(t){return 0===t.connections}))}(t)||r(t,n)};return e.map(function(t){var e=i(t);return e.connections++,[t,e.point]})},u=function(t){var e,n=r(t,2),i=n[0],o=n[1];return i.length===o.length?(e=o,i.map(function(t,n){return[t,e[n]]})):i.length>o.length?a(o,i):a(i,o).map(function(t){return t.reverse()})},s=function(t,e){return t[1]===e[1]?0:t[1]<e[1]?-1:1};e.exports=function(t,e){if(0===e.length)return[];var n=[];e.forEach(function(t){var e=t[0];n[e]||(n[e]=[]),n[e].push(t)});var a=(n=Object.values(n).map(function(t){return t.sort(s)}))[0],l=function(t){for(var e=[],n=0;n<=t.length-2;n++)e.push([t[n],t[n+1]]);return e}([n[n.length-1].map(o(-t[0]))].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(n),[a.map(o(t[0]))]));return l.map(u).reduce(function(t,e){return t.concat(e)}).map(function(t){var e=r(t,2),n=e[0],a=e[1],u=.8*(a[0]-n[0]),s=o(u)(n),l=o(-u)(a);return new i(n[0],n[1],s[0],s[1],l[0],l[1],a[0],a[1])})}},{"bezier-js":9}],3:[function(t,e,n){"use strict";var r,i=document.getElementById("data"),o=Array.from(i.children).map(function(t){return t.outerHTML}),a=Number(i.dataset.bpm),u=(r=i.dataset.voices.split(","))[Math.floor(Math.random()*r.length)],s=Array(19).fill(0).map(function(t,e){return"./img/art"+(e+1)+".svg"});e.exports={html:o,bpm:a,voice:u,symbols:s}},{}],4:[function(t,e,n){"use strict";var r=t("mithril"),i=t("./state"),o=i.state,a=i.emitter,u=t("./view/View"),s=function(){var t=[window.innerWidth,window.innerHeight];a.emit(o.events.RESIZE,t)};window.addEventListener("resize",s),s(),r.mount(document.body,u(o,a)),a.emit(o.events.LOAD)},{"./state":5,"./view/View":8,mithril:14}],5:[function(t,e,n){"use strict";var r=t("mithril"),i=t("events"),o=t("./curves"),a=t("./audio"),u=t("./data"),s=u.html,l=u.bpm,c=u.voice,f=[414,768],h=new i,d={events:{LOAD:"load",RESIZE:"resize",PLACE_CURSOR:"placeCursor",PLACE_NOTE:"placeNote",NOTE_PLAYED:"notePlayed"},loaded:!1,playing:!1,size:[1,1],art:[],notes:s.map(function(t,e){return{html:t,key:e,position:[-1,-1],visible:!1}}),sounds:["./audio/"+c+"_1.mp3","./audio/"+c+"_2.mp3","./audio/"+c+"_3.mp3","./audio/"+c+"_4.mp3","./audio/"+c+"_5.mp3","./audio/"+c+"_6.mp3","./audio/"+c+"_7.mp3"],cursor:!1,clicks:0,notesPlayed:0,beatDuration:1/(l/60),startTime:0,now:0,audioUntil:0},v=function(t,e){return t[0]===e[0]&&t[1]===e[1]},p=function(){return d.notes.filter(function(t){return t.visible})},m=function(){return p().map(function(t){return t.position}).concat(d.cursor?[d.cursor]:[])},y=function(){d.curves=o(d.size,m())},x=function(){d.startTime=a.context.currentTime,d.playing=!0,g()},g=function t(){var e=d.beatDuration*d.size[0],n=a.context.currentTime-d.startTime,i=d.audioUntil,o=n+.05,u=!1;m().forEach(function(t){for(var n=t[0]*d.beatDuration;n<i;)n+=e;if(n<o){var r=d.size[1]-1-t[1];a.play(d.sounds[r],n+d.startTime),u=!0,h.emit(d.events.NOTE_PLAYED,t)}}),u&&d.notesPlayed++,d.audioUntil=o,d.now=n%e,r.redraw(),requestAnimationFrame(t)};h.on(d.events.LOAD,function(){Promise.all(d.sounds.map(a.load)).then(function(t){d.sounds=t,d.loaded=!0,"running"===a.context.state?x():r.redraw()})}),h.on(d.events.RESIZE,function(t){var e=d.size;t[0]<=f[0]?d.size=[4,7]:d.size=[8,12],d.cellSize=[t[0]/d.size[0],t[1]/d.size[1]],v(e,d.size)||(d.clicks=0,d.notes.forEach(function(t){return t.visible=!1}),d.face=[-1,-1],d.cursor=!("ontouchstart"in window)&&[Math.floor(d.size[0]/2),Math.floor(d.size[1]/2)],y()),r.redraw()}),h.on(d.events.PLACE_NOTE,function(t){if(a.unlock(),d.playing||x(),!d.notes.some(function(e){return v(t,e.position)})){var e=d.notes[d.clicks%d.notes.length];e.position=t,e.visible=!0,d.clicks++,d.cursor=!1,y()}}),h.on(d.events.PLACE_CURSOR,function(t){if(!1!==t){var e=p().some(function(e){return v(t,e.position)});d.cursor=!e&&t}else d.cursor=t;y()}),e.exports={state:d,emitter:h}},{"./audio":1,"./curves":2,"./data":3,events:13,mithril:14}],6:[function(t,e,n){"use strict";var r=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=t("mithril"),o=function(t,e){return t.map(function(t){return n=function(t){return t.points.map(function(t){return[t.x,t.y]})}(t).map(function(t){return function(e){return[e[0]*t[0],e[1]*t[1]]}}(e)),i=function(t){return t[0]+" "+t[1]},o=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return t+" "+n.map(i).join(" ")},a=r(n,4),u=a[0],s=a[1],l=a[2],c=a[3],o("M",u)+" "+o("C",s,l,c);var n,i,o,a,u,s,l,c}).join(" ")};e.exports={view:function(t){var e=t.attrs,n=e.size,r=e.cellSize,a=e.curves,u=n[0]*r[0],s=n[1]*r[1];return i("svg.curves",{width:u,height:s},a.length>0&&i("path",{d:o(a,r),fill:"none",stroke:"var(--text-color)",strokeWidth:1}))}}},{mithril:14}],7:[function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var i=t("mithril");e.exports={view:function(t){var e=t.attrs,n=e.curves,o=e.size,a=e.cellSize,u=e.beatDuration,s=e.now;if(0!==n.length){var l=s/u,c={p1:{x:l,y:-1},p2:{x:l,y:o[1]+1}},f=n.filter(function(t){var e=t.compute(0).x,n=t.compute(1).x;return e<=l&&n>=l}),h=f.map(function(t){return t.intersects(c).map(function(e){var n=t.compute(e),r=n.x,i=n.y,o=t.normal(e),a=o.x,u=o.y;return{position:[r,i],angle:Math.atan2(u,a)-Math.PI/2}})}).reduce(function(t,e){return t.concat(e)},[]),d=[].concat(r(h.map(function(t){var e=t.position,n=t.angle;return{position:[e[0]-o[0],e[1]],angle:n}})),r(h),r(h.map(function(t){var e=t.position,n=t.angle;return{position:[e[0]+o[0],e[1]],angle:n}}))),v=-26*(5-Math.floor(8*s)%5-1)+"px 0";return d.map(function(t,e){var n=t.position,r=t.angle,o=n[0]*a[0],u=n[1]*a[1];return i(".man",{style:{transform:"translate( "+o+"px, "+u+"px )"+" "+("rotate( "+r+"rad )"),maskPosition:v,"-webkit-mask-position":v},key:e})})}}}},{mithril:14}],8:[function(t,e,n){"use strict";var r=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=t("mithril"),o=t("./Curves"),a=t("./Men"),u=t("../data").symbols,s="ontouchstart"in window,l=function(t,e){return t+Math.floor(Math.random()*(e-t))},c=Math.PI/180,f=function(t,e){var n=r(e,2),i=n[0],o=n[1];return"translate("+i*t[0]+"px, "+o*t[1]+"px)"},h=function(t,e){var n,r=document.createElement("img");r.classList.add("face"),r.src=(n=u)[Math.floor(Math.random()*n.length)],document.body.appendChild(r);var i=[e[0]*t[0],e[1]*t[1]],o=[l(-500,500),l(-750,-1250)],a=l(-10,10)*c,s=l(-90,90)*c,f=Date.now()/1e3;!function t(){var e=Date.now()/1e3,n=e-f;f=e,i[0]+=o[0]*n,i[1]+=o[1]*n,o[1]+=2e3*n,a+=s*n,r.style.transform="\n      translate("+i[0]+"px, "+i[1]+"px)\n      rotate("+a+"rad)",i[1]>window.innerHeight?r.remove():requestAnimationFrame(t)}()};e.exports=function(t,e){return{oncreate:function(){console.log("init"),e.on(t.events.NOTE_PLAYED,function(e){console.log(e),h(t.cellSize,e)})},view:function(){var n=t.loaded,r=t.playing,u=t.size,l=t.cellSize,c=t.notes,h=t.curves,d=t.cursor,v=(t.art,t.now),p=t.beatDuration;if(!n)return i(".center","boading...");var m=function(t){return function(n){var r=window.innerWidth,i=window.innerHeight,o=Math.floor(n.clientX/r*u[0]),a=Math.floor(n.clientY/i*u[1]);e.emit(t,[o,a])}};return i(".main",{onclick:m(t.events.PLACE_NOTE),onmousemove:!s&&m(t.events.PLACE_CURSOR)},s&&c.every(function(t){return!t.visible})&&i(".center","touch me"),r&&i(a,{size:u,cellSize:l,curves:h,beatDuration:p,now:v}),i(o,{size:u,cellSize:l,curves:h}),d&&i(".cursor",{style:{transform:f(l,d)}}),c.filter(function(t){return t.visible}).map(function(t){var e=t.position,n=t.key,r=t.html,o={maxWidth:l[0]+"px",transform:f(l,e)};return i("div",{key:n,style:o},i.trust(r))}))}}}},{"../data":3,"./Curves":6,"./Men":7,mithril:14}],9:[function(t,e,n){e.exports=t("./lib/bezier")},{"./lib/bezier":10}],10:[function(t,e,n){!function(){"use strict";var n=Math.abs,r=Math.min,i=Math.max,o=Math.cos,a=Math.sin,u=Math.acos,s=Math.sqrt,l=Math.PI,c={x:0,y:0,z:0},f=t("./utils.js"),h=t("./poly-bezier.js"),d=function(t){var e=t&&t.forEach?t:[].slice.call(arguments),r=!1;if("object"==typeof e[0]){r=e.length;var i=[];e.forEach(function(t){["x","y","z"].forEach(function(e){void 0!==t[e]&&i.push(t[e])})}),e=i}var o=!1,a=e.length;if(r){if(r>4){if(1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");o=!0}}else if(6!==a&&8!==a&&9!==a&&12!==a&&1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");var u=!o&&(9===a||12===a)||t&&t[0]&&void 0!==t[0].z;this._3d=u;for(var s=[],l=0,c=u?3:2;l<a;l+=c){var h={x:e[l],y:e[l+1]};u&&(h.z=e[l+2]),s.push(h)}this.order=s.length-1,this.points=s;var d=["x","y"];u&&d.push("z"),this.dims=d,this.dimlen=d.length,function(t){for(var e=t.order,r=t.points,i=f.align(r,{p1:r[0],p2:r[e]}),o=0;o<i.length;o++)if(n(i[o].y)>1e-4)return void(t._linear=!1);t._linear=!0}(this),this._t1=0,this._t2=1,this.update()};function v(t,e,n,r,i){void 0===i&&(i=.5);var o=f.projectionratio(i,t),a=1-o,u={x:o*e.x+a*r.x,y:o*e.y+a*r.y},s=f.abcratio(i,t);return{A:{x:n.x+(n.x-u.x)/s,y:n.y+(n.y-u.y)/s},B:n,C:u}}d.fromSVG=function(t){var e=t.match(/[-+]?\d*\.?\d+(?:[eE][-+]?\d+)?/g).map(parseFloat);return/[cq]/.test(t)?(e=e.map(function(t,n){return n<2?t:t+e[n%2]}),new d(e)):new d(e)},d.quadraticFromPoints=function(t,e,n,r){if(void 0===r&&(r=.5),0===r)return new d(e,e,n);if(1===r)return new d(t,e,e);var i=v(2,t,e,n,r);return new d(t,i.A,n)},d.cubicFromPoints=function(t,e,n,r,i){void 0===r&&(r=.5);var o=v(3,t,e,n,r);void 0===i&&(i=f.dist(e,o.C));var a=i*(1-r)/r,u=f.dist(t,n),s=(n.x-t.x)/u,l=(n.y-t.y)/u,c=i*s,h=i*l,p=a*s,m=a*l,y=e.x-c,x=e.y-h,g=e.x+p,w=e.y+m,b=o.A,z=b.x+(y-b.x)/(1-r),_=b.y+(x-b.y)/(1-r),E=b.x+(g-b.x)/r,k=b.y+(w-b.y)/r,A={x:t.x+(z-t.x)/r,y:t.y+(_-t.y)/r},S={x:n.x+(E-n.x)/(1-r),y:n.y+(k-n.y)/(1-r)};return new d(t,A,S,n)};var p=function(){return f};d.getUtils=p,d.prototype={getUtils:p,valueOf:function(){return this.toString()},toString:function(){return f.pointsToString(this.points)},toSVG:function(t){if(this._3d)return!1;for(var e=this.points,n=["M",e[0].x,e[0].y,2===this.order?"Q":"C"],r=1,i=e.length;r<i;r++)n.push(e[r].x),n.push(e[r].y);return n.join(" ")},update:function(){this.dpoints=[];for(var t=this.points,e=t.length,n=e-1;e>1;e--,n--){for(var r,i=[],o=0;o<n;o++)r={x:n*(t[o+1].x-t[o].x),y:n*(t[o+1].y-t[o].y)},this._3d&&(r.z=n*(t[o+1].z-t[o].z)),i.push(r);this.dpoints.push(i),t=i}this.computedirection()},computedirection:function(){var t=this.points,e=f.angle(t[0],t[this.order],t[1]);this.clockwise=e>0},length:function(){return f.length(this.derivative.bind(this))},_lut:[],getLUT:function(t){if(t=t||100,this._lut.length===t)return this._lut;this._lut=[];for(var e=0;e<=t;e++)this._lut.push(this.compute(e/t));return this._lut},on:function(t,e){e=e||5;for(var n,r=this.getLUT(),i=[],o=0,a=0;a<r.length;a++)n=r[a],f.dist(n,t)<e&&(i.push(n),o+=a/r.length);return!!i.length&&o/i.length},project:function(t){var e=this.getLUT(),n=e.length-1,r=f.closest(e,t),i=r.mdist,o=r.mpos;if(0===o||o===n){var a=o/n,u=this.compute(a);return u.t=a,u.d=i,u}var s,l,c,h=(o+1)/n,d=.1/n;for(i+=1,s=a=(o-1)/n;a<h+d;a+=d)l=this.compute(a),(c=f.dist(t,l))<i&&(i=c,s=a);return(l=this.compute(s)).t=s,l.d=i,l},get:function(t){return this.compute(t)},point:function(t){return this.points[t]},compute:function(t){if(0===t)return this.points[0];if(1===t)return this.points[this.order];var e=this.points,n=1-t;if(1===this.order)return l={x:n*e[0].x+t*e[1].x,y:n*e[0].y+t*e[1].y},this._3d&&(l.z=n*e[0].z+t*e[1].z),l;if(this.order<4){var r,i,o,a=n*n,u=t*t,s=0;2===this.order?(e=[e[0],e[1],e[2],c],r=a,i=n*t*2,o=u):3===this.order&&(r=a*n,i=a*t*3,o=n*u*3,s=t*u);var l={x:r*e[0].x+i*e[1].x+o*e[2].x+s*e[3].x,y:r*e[0].y+i*e[1].y+o*e[2].y+s*e[3].y};return this._3d&&(l.z=r*e[0].z+i*e[1].z+o*e[2].z+s*e[3].z),l}for(var f=JSON.parse(JSON.stringify(this.points));f.length>1;){for(var h=0;h<f.length-1;h++)f[h]={x:f[h].x+(f[h+1].x-f[h].x)*t,y:f[h].y+(f[h+1].y-f[h].y)*t},void 0!==f[h].z&&(f[h]=f[h].z+(f[h+1].z-f[h].z)*t);f.splice(f.length-1,1)}return f[0]},raise:function(){for(var t,e,n=this.points,r=[n[0]],i=n.length,o=1;o<i;o++)t=n[o],e=n[o-1],r[o]={x:(i-o)/i*t.x+o/i*e.x,y:(i-o)/i*t.y+o/i*e.y};return r[i]=n[i-1],new d(r)},derivative:function(t){var e,n,r=1-t,i=0,o=this.dpoints[0];2===this.order&&(o=[o[0],o[1],c],e=r,n=t),3===this.order&&(e=r*r,n=r*t*2,i=t*t);var a={x:e*o[0].x+n*o[1].x+i*o[2].x,y:e*o[0].y+n*o[1].y+i*o[2].y};return this._3d&&(a.z=e*o[0].z+n*o[1].z+i*o[2].z),a},inflections:function(){return f.inflections(this.points)},normal:function(t){return this._3d?this.__normal3(t):this.__normal2(t)},__normal2:function(t){var e=this.derivative(t),n=s(e.x*e.x+e.y*e.y);return{x:-e.y/n,y:e.x/n}},__normal3:function(t){var e=this.derivative(t),n=this.derivative(t+.01),r=s(e.x*e.x+e.y*e.y+e.z*e.z),i=s(n.x*n.x+n.y*n.y+n.z*n.z);e.x/=r,e.y/=r,e.z/=r,n.x/=i,n.y/=i,n.z/=i;var o={x:n.y*e.z-n.z*e.y,y:n.z*e.x-n.x*e.z,z:n.x*e.y-n.y*e.x},a=s(o.x*o.x+o.y*o.y+o.z*o.z);o.x/=a,o.y/=a,o.z/=a;var u=[o.x*o.x,o.x*o.y-o.z,o.x*o.z+o.y,o.x*o.y+o.z,o.y*o.y,o.y*o.z-o.x,o.x*o.z-o.y,o.y*o.z+o.x,o.z*o.z];return{x:u[0]*e.x+u[1]*e.y+u[2]*e.z,y:u[3]*e.x+u[4]*e.y+u[5]*e.z,z:u[6]*e.x+u[7]*e.y+u[8]*e.z}},hull:function(t){var e,n=this.points,r=[],i=[],o=0,a=0,u=0;for(i[o++]=n[0],i[o++]=n[1],i[o++]=n[2],3===this.order&&(i[o++]=n[3]);n.length>1;){for(r=[],a=0,u=n.length-1;a<u;a++)e=f.lerp(t,n[a],n[a+1]),i[o++]=e,r.push(e);n=r}return i},split:function(t,e){if(0===t&&e)return this.split(e).left;if(1===e)return this.split(t).right;var n=this.hull(t),r={left:2===this.order?new d([n[0],n[3],n[5]]):new d([n[0],n[4],n[7],n[9]]),right:2===this.order?new d([n[5],n[4],n[2]]):new d([n[9],n[8],n[6],n[3]]),span:n};return r.left._t1=f.map(0,0,1,this._t1,this._t2),r.left._t2=f.map(t,0,1,this._t1,this._t2),r.right._t1=f.map(t,0,1,this._t1,this._t2),r.right._t2=f.map(1,0,1,this._t1,this._t2),e?(e=f.map(e,t,1,0,1),r.right.split(e).left):r},extrema:function(){var t,e,n=this.dims,r={},i=[];return n.forEach(function(n){e=function(t){return t[n]},t=this.dpoints[0].map(e),r[n]=f.droots(t),3===this.order&&(t=this.dpoints[1].map(e),r[n]=r[n].concat(f.droots(t))),r[n]=r[n].filter(function(t){return t>=0&&t<=1}),i=i.concat(r[n].sort())}.bind(this)),i=i.sort().filter(function(t,e){return i.indexOf(t)===e}),r.values=i,r},bbox:function(){var t=this.extrema(),e={};return this.dims.forEach(function(n){e[n]=f.getminmax(this,n,t[n])}.bind(this)),e},overlaps:function(t){var e=this.bbox(),n=t.bbox();return f.bboxoverlap(e,n)},offset:function(t,e){if(void 0!==e){var n=this.get(t),r=this.normal(t),i={c:n,n:r,x:n.x+r.x*e,y:n.y+r.y*e};return this._3d&&(i.z=n.z+r.z*e),i}if(this._linear){var o=this.normal(0),a=this.points.map(function(e){var n={x:e.x+t*o.x,y:e.y+t*o.y};return e.z&&r.z&&(n.z=e.z+t*o.z),n});return[new d(a)]}return this.reduce().map(function(e){return e.scale(t)})},simple:function(){if(3===this.order){var t=f.angle(this.points[0],this.points[3],this.points[1]),e=f.angle(this.points[0],this.points[3],this.points[2]);if(t>0&&e<0||t<0&&e>0)return!1}var r=this.normal(0),i=this.normal(1),o=r.x*i.x+r.y*i.y;return this._3d&&(o+=r.z*i.z),n(u(o))<l/3},reduce:function(){var t,e,r=0,i=0,o=[],a=[],u=this.extrema().values;for(-1===u.indexOf(0)&&(u=[0].concat(u)),-1===u.indexOf(1)&&u.push(1),r=u[0],t=1;t<u.length;t++)i=u[t],(e=this.split(r,i))._t1=r,e._t2=i,o.push(e),r=i;return o.forEach(function(t){for(r=0,i=0;i<=1;)for(i=r+.01;i<=1.01;i+=.01)if(!(e=t.split(r,i)).simple()){if(n(r-(i-=.01))<.01)return[];(e=t.split(r,i))._t1=f.map(r,0,1,t._t1,t._t2),e._t2=f.map(i,0,1,t._t1,t._t2),a.push(e),r=i;break}r<1&&((e=t.split(r,1))._t1=f.map(r,0,1,t._t1,t._t2),e._t2=t._t2,a.push(e))}),a},scale:function(t){var e=this.order,n=!1;if("function"==typeof t&&(n=t),n&&2===e)return this.raise().scale(n);var r=this.clockwise,i=n?n(0):t,o=n?n(1):t,a=[this.offset(0,10),this.offset(1,10)],u=f.lli4(a[0],a[0].c,a[1],a[1].c);if(!u)throw new Error("cannot scale this curve. Try reducing it first.");var l=this.points,c=[];return[0,1].forEach(function(t){var n=c[t*e]=f.copy(l[t*e]);n.x+=(t?o:i)*a[t].n.x,n.y+=(t?o:i)*a[t].n.y}.bind(this)),n?([0,1].forEach(function(i){if(2!==this.order||!i){var o=l[i+1],a={x:o.x-u.x,y:o.y-u.y},f=n?n((i+1)/e):t;n&&!r&&(f=-f);var h=s(a.x*a.x+a.y*a.y);a.x/=h,a.y/=h,c[i+1]={x:o.x+f*a.x,y:o.y+f*a.y}}}.bind(this)),new d(c)):([0,1].forEach(function(t){if(2!==this.order||!t){var n=c[t*e],r=this.derivative(t),i={x:n.x+r.x,y:n.y+r.y};c[t+1]=f.lli4(n,i,u,l[t+1])}}.bind(this)),new d(c))},outline:function(t,e,n,r){e=void 0===e?t:e;var i,o=this.reduce(),a=o.length,u=[],s=[],l=0,c=this.length(),d=void 0!==n&&void 0!==r;function v(t,e,n,r,i){return function(o){var a=r/n,u=(r+i)/n,s=e-t;return f.map(o,0,1,t+a*s,t+u*s)}}o.forEach(function(i){z=i.length(),d?(u.push(i.scale(v(t,n,c,l,z))),s.push(i.scale(v(-e,-r,c,l,z)))):(u.push(i.scale(t)),s.push(i.scale(-e))),l+=z}),s=s.map(function(t){return(i=t.points)[3]?t.points=[i[3],i[2],i[1],i[0]]:t.points=[i[2],i[1],i[0]],t}).reverse();var p=u[0].points[0],m=u[a-1].points[u[a-1].points.length-1],y=s[a-1].points[s[a-1].points.length-1],x=s[0].points[0],g=f.makeline(y,p),w=f.makeline(m,x),b=[g].concat(u).concat([w]).concat(s),z=b.length;return new h(b)},outlineshapes:function(t,e,n){e=e||t;for(var r=this.outline(t,e).curves,i=[],o=1,a=r.length;o<a/2;o++){var u=f.makeshape(r[o],r[a-o],n);u.startcap.virtual=o>1,u.endcap.virtual=o<a/2-1,i.push(u)}return i},intersects:function(t,e){return t?t.p1&&t.p2?this.lineIntersects(t):(t instanceof d&&(t=t.reduce()),this.curveintersects(this.reduce(),t,e)):this.selfintersects(e)},lineIntersects:function(t){var e=r(t.p1.x,t.p2.x),n=r(t.p1.y,t.p2.y),o=i(t.p1.x,t.p2.x),a=i(t.p1.y,t.p2.y),u=this;return f.roots(this.points,t).filter(function(t){var r=u.get(t);return f.between(r.x,e,o)&&f.between(r.y,n,a)})},selfintersects:function(t){var e,n,r,i,o=this.reduce(),a=o.length-2,u=[];for(e=0;e<a;e++)r=o.slice(e,e+1),i=o.slice(e+2),n=this.curveintersects(r,i,t),u=u.concat(n);return u},curveintersects:function(t,e,n){var r=[];t.forEach(function(t){e.forEach(function(e){t.overlaps(e)&&r.push({left:t,right:e})})});var i=[];return r.forEach(function(t){var e=f.pairiteration(t.left,t.right,n);e.length>0&&(i=i.concat(e))}),i},arcs:function(t){t=t||.5;return this._iterate(t,[])},_error:function(t,e,r,i){var o=(i-r)/4,a=this.get(r+o),u=this.get(i-o),s=f.dist(t,e),l=f.dist(t,a),c=f.dist(t,u);return n(l-s)+n(c-s)},_iterate:function(t,e){var n,r=0,i=1;do{n=0,i=1;var u,s,l,c,h,d=this.get(r),v=!1,p=!1,m=i,y=1;do{if(p=v,c=l,m=(r+i)/2,0,u=this.get(m),s=this.get(i),(l=f.getccenter(d,u,s)).interval={start:r,end:i},v=this._error(l,d,r,i)<=t,(h=p&&!v)||(y=i),v){if(i>=1){if(l.interval.end=y=1,c=l,i>1){var x={x:l.x+l.r*o(l.e),y:l.y+l.r*a(l.e)};l.e+=f.angle({x:l.x,y:l.y},x,this.get(1))}break}i+=(i-r)/2}else i=m}while(!h&&n++<100);if(n>=100)break;c=c||l,e.push(c),r=y}while(i<1);return e}},e.exports=d}()},{"./poly-bezier.js":11,"./utils.js":12}],11:[function(t,e,n){!function(){"use strict";var n=t("./utils.js"),r=function(t){this.curves=[],this._3d=!1,t&&(this.curves=t,this._3d=this.curves[0]._3d)};r.prototype={valueOf:function(){return this.toString()},toString:function(){return"["+this.curves.map(function(t){return n.pointsToString(t.points)}).join(", ")+"]"},addCurve:function(t){this.curves.push(t),this._3d=this._3d||t._3d},length:function(){return this.curves.map(function(t){return t.length()}).reduce(function(t,e){return t+e})},curve:function(t){return this.curves[t]},bbox:function(){for(var t=this.curves,e=t[0].bbox(),r=1;r<t.length;r++)n.expandbox(e,t[r].bbox());return e},offset:function(t){var e=[];return this.curves.forEach(function(n){e=e.concat(n.offset(t))}),new r(e)}},e.exports=r}()},{"./utils.js":12}],12:[function(t,e,n){!function(){"use strict";var n=Math.abs,r=Math.cos,i=Math.sin,o=Math.acos,a=Math.atan2,u=Math.sqrt,s=Math.pow,l=function(t){return t<0?-s(-t,1/3):s(t,1/3)},c=Math.PI,f=2*c,h=c/2,d=Number.MAX_SAFE_INTEGER,v=Number.MIN_SAFE_INTEGER,p={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(t,e){var n=e(t),r=n.x*n.x+n.y*n.y;return void 0!==n.z&&(r+=n.z*n.z),u(r)},between:function(t,e,n){return e<=t&&t<=n||p.approximately(t,e)||p.approximately(t,n)},approximately:function(t,e,r){return n(t-e)<=(r||1e-6)},length:function(t){var e,n,r=0,i=p.Tvalues.length;for(e=0;e<i;e++)n=.5*p.Tvalues[e]+.5,r+=p.Cvalues[e]*p.arcfn(n,t);return.5*r},map:function(t,e,n,r,i){return r+(i-r)*((t-e)/(n-e))},lerp:function(t,e,n){var r={x:e.x+t*(n.x-e.x),y:e.y+t*(n.y-e.y)};return e.z&&n.z&&(r.z=e.z+t*(n.z-e.z)),r},pointToString:function(t){var e=t.x+"/"+t.y;return void 0!==t.z&&(e+="/"+t.z),e},pointsToString:function(t){return"["+t.map(p.pointToString).join(", ")+"]"},copy:function(t){return JSON.parse(JSON.stringify(t))},angle:function(t,e,n){var r=e.x-t.x,i=e.y-t.y,o=n.x-t.x,u=n.y-t.y;return a(r*u-i*o,r*o+i*u)},round:function(t,e){var n=""+t,r=n.indexOf(".");return parseFloat(n.substring(0,r+1+e))},dist:function(t,e){var n=t.x-e.x,r=t.y-e.y;return u(n*n+r*r)},closest:function(t,e){var n,r,i=s(2,63);return t.forEach(function(t,o){(r=p.dist(e,t))<i&&(i=r,n=o)}),{mdist:i,mpos:n}},abcratio:function(t,e){if(2!==e&&3!==e)return!1;if(void 0===t)t=.5;else if(0===t||1===t)return t;var r=s(t,e)+s(1-t,e);return n((r-1)/r)},projectionratio:function(t,e){if(2!==e&&3!==e)return!1;if(void 0===t)t=.5;else if(0===t||1===t)return t;var n=s(1-t,e);return n/(s(t,e)+n)},lli8:function(t,e,n,r,i,o,a,u){var s=(t-n)*(o-u)-(e-r)*(i-a);return 0!=s&&{x:((t*r-e*n)*(i-a)-(t-n)*(i*u-o*a))/s,y:((t*r-e*n)*(o-u)-(e-r)*(i*u-o*a))/s}},lli4:function(t,e,n,r){var i=t.x,o=t.y,a=e.x,u=e.y,s=n.x,l=n.y,c=r.x,f=r.y;return p.lli8(i,o,a,u,s,l,c,f)},lli:function(t,e){return p.lli4(t,t.c,e,e.c)},makeline:function(e,n){var r=t("./bezier"),i=e.x,o=e.y,a=n.x,u=n.y,s=(a-i)/3,l=(u-o)/3;return new r(i,o,i+s,o+l,i+2*s,o+2*l,a,u)},findbbox:function(t){var e=d,n=d,r=v,i=v;return t.forEach(function(t){var o=t.bbox();e>o.x.min&&(e=o.x.min),n>o.y.min&&(n=o.y.min),r<o.x.max&&(r=o.x.max),i<o.y.max&&(i=o.y.max)}),{x:{min:e,mid:(e+r)/2,max:r,size:r-e},y:{min:n,mid:(n+i)/2,max:i,size:i-n}}},shapeintersections:function(t,e,n,r,i){if(!p.bboxoverlap(e,r))return[];var o=[],a=[t.startcap,t.forward,t.back,t.endcap],u=[n.startcap,n.forward,n.back,n.endcap];return a.forEach(function(e){e.virtual||u.forEach(function(r){if(!r.virtual){var a=e.intersects(r,i);a.length>0&&(a.c1=e,a.c2=r,a.s1=t,a.s2=n,o.push(a))}})}),o},makeshape:function(t,e,n){var r=e.points.length,i=t.points.length,o=p.makeline(e.points[r-1],t.points[0]),a=p.makeline(t.points[i-1],e.points[0]),u={startcap:o,forward:t,back:e,endcap:a,bbox:p.findbbox([o,t,e,a])},s=p;return u.intersections=function(t){return s.shapeintersections(u,u.bbox,t,t.bbox,n)},u},getminmax:function(t,e,n){if(!n)return{min:0,max:0};var r,i,o=d,a=v;-1===n.indexOf(0)&&(n=[0].concat(n)),-1===n.indexOf(1)&&n.push(1);for(var u=0,s=n.length;u<s;u++)r=n[u],(i=t.get(r))[e]<o&&(o=i[e]),i[e]>a&&(a=i[e]);return{min:o,mid:(o+a)/2,max:a,size:a-o}},align:function(t,e){var n=e.p1.x,o=e.p1.y,u=-a(e.p2.y-o,e.p2.x-n);return t.map(function(t){return{x:(t.x-n)*r(u)-(t.y-o)*i(u),y:(t.x-n)*i(u)+(t.y-o)*r(u)}})},roots:function(t,e){e=e||{p1:{x:0,y:0},p2:{x:1,y:0}};var n=t.length-1,i=p.align(t,e),a=function(t){return 0<=t&&t<=1};if(2===n){if(0!==(h=(d=i[0].y)-2*(v=i[1].y)+(m=i[2].y))){var s=-u(v*v-d*m),c=-d+v;return[-(s+c)/h,-(-s+c)/h].filter(a)}return v!==m&&0===h?[(2*v-m)/2*(v-m)].filter(a):[]}var h,d,v,m,y,x=i[0].y,g=i[1].y,w=i[2].y,b=(i=(3*(v=(-3*x+3*g)/(h=3*g-x-3*w+i[3].y))-(d=(3*x-6*g+3*w)/h)*d)/3)/3,z=(2*d*d*d-9*d*v+27*(m=x/h))/27,_=z/2,E=_*_+b*b*b;if(E<0){var k=-i/3,A=u(k*k*k),S=-z/(2*A),C=o(S<-1?-1:S>1?1:S),L=2*l(A);return[L*r(C/3)-d/3,L*r((C+f)/3)-d/3,L*r((C+2*f)/3)-d/3].filter(a)}if(0===E)return[2*(y=_<0?l(-_):-l(_))-d/3,-y-d/3].filter(a);var O=u(E);return[(y=l(-_+O))-l(_+O)-d/3].filter(a)},droots:function(t){if(3===t.length){var e=t[0],n=t[1],r=t[2],i=e-2*n+r;if(0!==i){var o=-u(n*n-e*r),a=-e+n;return[-(o+a)/i,-(-o+a)/i]}return n!==r&&0===i?[(2*n-r)/(2*(n-r))]:[]}if(2===t.length)return(e=t[0])!==(n=t[1])?[e/(e-n)]:[]},inflections:function(t){if(t.length<4)return[];var e=p.align(t,{p1:t[0],p2:t.slice(-1)[0]}),n=e[2].x*e[1].y,r=e[3].x*e[1].y,i=e[1].x*e[2].y,o=18*(-3*n+2*r+3*i-(f=e[3].x*e[2].y)),a=18*(3*n-r-3*i),u=18*(i-n);if(p.approximately(o,0)){if(!p.approximately(a,0)){var s=-u/a;if(0<=s&&s<=1)return[s]}return[]}var l=a*a-4*o*u,c=Math.sqrt(l),f=2*o;return p.approximately(f,0)?[]:[(c-a)/f,-(a+c)/f].filter(function(t){return 0<=t&&t<=1})},bboxoverlap:function(t,e){var r,i,o,a,u,s=["x","y"],l=s.length;for(r=0;r<l;r++)if(o=t[i=s[r]].mid,a=e[i].mid,u=(t[i].size+e[i].size)/2,n(o-a)>=u)return!1;return!0},expandbox:function(t,e){e.x.min<t.x.min&&(t.x.min=e.x.min),e.y.min<t.y.min&&(t.y.min=e.y.min),e.z&&e.z.min<t.z.min&&(t.z.min=e.z.min),e.x.max>t.x.max&&(t.x.max=e.x.max),e.y.max>t.y.max&&(t.y.max=e.y.max),e.z&&e.z.max>t.z.max&&(t.z.max=e.z.max),t.x.mid=(t.x.min+t.x.max)/2,t.y.mid=(t.y.min+t.y.max)/2,t.z&&(t.z.mid=(t.z.min+t.z.max)/2),t.x.size=t.x.max-t.x.min,t.y.size=t.y.max-t.y.min,t.z&&(t.z.size=t.z.max-t.z.min)},pairiteration:function(t,e,n){var r=t.bbox(),i=e.bbox(),o=1e5,a=n||.5;if(r.x.size+r.y.size<a&&i.x.size+i.y.size<a)return[(o*(t._t1+t._t2)/2|0)/o+"/"+(o*(e._t1+e._t2)/2|0)/o];var u=t.split(.5),s=e.split(.5),l=[{left:u.left,right:s.left},{left:u.left,right:s.right},{left:u.right,right:s.right},{left:u.right,right:s.left}];l=l.filter(function(t){return p.bboxoverlap(t.left.bbox(),t.right.bbox())});var c=[];return 0===l.length?c:(l.forEach(function(t){c=c.concat(p.pairiteration(t.left,t.right,a))}),c=c.filter(function(t,e){return c.indexOf(t)===e}))},getccenter:function(t,e,n){var o,u=e.x-t.x,s=e.y-t.y,l=n.x-e.x,c=n.y-e.y,d=u*r(h)-s*i(h),v=u*i(h)+s*r(h),m=l*r(h)-c*i(h),y=l*i(h)+c*r(h),x=(t.x+e.x)/2,g=(t.y+e.y)/2,w=(e.x+n.x)/2,b=(e.y+n.y)/2,z=x+d,_=g+v,E=w+m,k=b+y,A=p.lli8(x,g,z,_,w,b,E,k),S=p.dist(A,t),C=a(t.y-A.y,t.x-A.x),L=a(e.y-A.y,e.x-A.x),O=a(n.y-A.y,n.x-A.x);return C<O?((C>L||L>O)&&(C+=f),C>O&&(o=O,O=C,C=o)):O<L&&L<C?(o=O,O=C,C=o):O+=f,A.s=C,A.e=O,A.r=S,A}};e.exports=p}()},{"./bezier":10}],13:[function(t,e,n){var r=Object.create||function(t){var e=function(){};return e.prototype=t,new e},i=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return n},o=Function.prototype.bind||function(t){var e=this;return function(){return e.apply(t,arguments)}};function a(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=r(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}e.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._maxListeners=void 0;var u,s=10;try{var l={};Object.defineProperty&&Object.defineProperty(l,"x",{value:0}),u=0===l.x}catch(t){u=!1}function c(t){return void 0===t._maxListeners?a.defaultMaxListeners:t._maxListeners}function f(t,e,n,i){var o,a,u;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((a=t._events)?(a.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),a=t._events),u=a[e]):(a=t._events=r(null),t._eventsCount=0),u){if("function"==typeof u?u=a[e]=i?[n,u]:[u,n]:i?u.unshift(n):u.push(n),!u.warned&&(o=c(t))&&o>0&&u.length>o){u.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+u.length+' "'+String(e)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');s.name="MaxListenersExceededWarning",s.emitter=t,s.type=e,s.count=u.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",s.name,s.message)}}else u=a[e]=n,++t._eventsCount;return t}function h(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];this.listener.apply(this.target,t)}}function d(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=o.call(h,r);return i.listener=n,r.wrapFn=i,i}function v(t){var e=this._events;if(e){var n=e[t];if("function"==typeof n)return 1;if(n)return n.length}return 0}function p(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}u?Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(t){if("number"!=typeof t||t<0||t!=t)throw new TypeError('"defaultMaxListeners" must be a positive number');s=t}}):a.defaultMaxListeners=s,a.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},a.prototype.getMaxListeners=function(){return c(this)},a.prototype.emit=function(t){var e,n,r,i,o,a,u="error"===t;if(a=this._events)u=u&&null==a.error;else if(!u)return!1;if(u){if(arguments.length>1&&(e=arguments[1]),e instanceof Error)throw e;var s=new Error('Unhandled "error" event. ('+e+")");throw s.context=e,s}if(!(n=a[t]))return!1;var l="function"==typeof n;switch(r=arguments.length){case 1:!function(t,e,n){if(e)t.call(n);else for(var r=t.length,i=p(t,r),o=0;o<r;++o)i[o].call(n)}(n,l,this);break;case 2:!function(t,e,n,r){if(e)t.call(n,r);else for(var i=t.length,o=p(t,i),a=0;a<i;++a)o[a].call(n,r)}(n,l,this,arguments[1]);break;case 3:!function(t,e,n,r,i){if(e)t.call(n,r,i);else for(var o=t.length,a=p(t,o),u=0;u<o;++u)a[u].call(n,r,i)}(n,l,this,arguments[1],arguments[2]);break;case 4:!function(t,e,n,r,i,o){if(e)t.call(n,r,i,o);else for(var a=t.length,u=p(t,a),s=0;s<a;++s)u[s].call(n,r,i,o)}(n,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),o=1;o<r;o++)i[o-1]=arguments[o];!function(t,e,n,r){if(e)t.apply(n,r);else for(var i=t.length,o=p(t,i),a=0;a<i;++a)o[a].apply(n,r)}(n,l,this,i)}return!0},a.prototype.addListener=function(t,e){return f(this,t,e,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(t,e){return f(this,t,e,!0)},a.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.on(t,d(this,t,e)),this},a.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.prependListener(t,d(this,t,e)),this},a.prototype.removeListener=function(t,e){var n,i,o,a,u;if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');if(!(i=this._events))return this;if(!(n=i[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=r(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(o=-1,a=n.length-1;a>=0;a--)if(n[a]===e||n[a].listener===e){u=n[a].listener,o=a;break}if(o<0)return this;0===o?n.shift():function(t,e){for(var n=e,r=n+1,i=t.length;r<i;n+=1,r+=1)t[n]=t[r];t.pop()}(n,o),1===n.length&&(i[t]=n[0]),i.removeListener&&this.emit("removeListener",t,u||e)}return this},a.prototype.removeAllListeners=function(t){var e,n,o;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=r(null),this._eventsCount=0):n[t]&&(0==--this._eventsCount?this._events=r(null):delete n[t]),this;if(0===arguments.length){var a,u=i(n);for(o=0;o<u.length;++o)"removeListener"!==(a=u[o])&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=r(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(e)for(o=e.length-1;o>=0;o--)this.removeListener(t,e[o]);return this},a.prototype.listeners=function(t){var e,n=this._events;return n&&(e=n[t])?"function"==typeof e?[e.listener||e]:function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(e):[]},a.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):v.call(t,e)},a.prototype.listenerCount=v,a.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],14:[function(t,e,n){(function(t){!function(){"use strict";function n(t,e,n,r,i,o){return{tag:t,key:e,attrs:n,children:r,text:i,dom:o,domSize:void 0,state:void 0,_state:void 0,events:void 0,instance:void 0,skip:!1}}n.normalize=function(t){return Array.isArray(t)?n("[",void 0,void 0,n.normalizeChildren(t),void 0,void 0):null!=t&&"object"!=typeof t?n("#",void 0,void 0,!1===t?"":t,void 0,void 0):t},n.normalizeChildren=function(t){for(var e=0;e<t.length;e++)t[e]=n.normalize(t[e]);return t};var r=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,i={},o={}.hasOwnProperty;function a(t){for(var e in t)if(o.call(t,e))return!1;return!0}function u(t){var e,u=arguments[1],s=2;if(null==t||"string"!=typeof t&&"function"!=typeof t&&"function"!=typeof t.view)throw Error("The selector must be either a string or a component.");if("string"==typeof t)var l=i[t]||function(t){for(var e,n="div",o=[],a={};e=r.exec(t);){var u=e[1],s=e[2];if(""===u&&""!==s)n=s;else if("#"===u)a.id=s;else if("."===u)o.push(s);else if("["===e[3][0]){var l=e[6];l&&(l=l.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")),"class"===e[4]?o.push(l):a[e[4]]=""===l?l:l||!0}}return o.length>0&&(a.className=o.join(" ")),i[t]={tag:n,attrs:a}}(t);if(null==u?u={}:("object"!=typeof u||null!=u.tag||Array.isArray(u))&&(u={},s=1),arguments.length===s+1)e=arguments[s],Array.isArray(e)||(e=[e]);else for(e=[];s<arguments.length;)e.push(arguments[s++]);var c=n.normalizeChildren(e);return"string"==typeof t?function(t,e,r){var i,u,s=!1,l=e.className||e.class;if(!a(t.attrs)&&!a(e)){var c={};for(var f in e)o.call(e,f)&&(c[f]=e[f]);e=c}for(var f in t.attrs)o.call(t.attrs,f)&&(e[f]=t.attrs[f]);for(var f in void 0!==l&&(void 0!==e.class&&(e.class=void 0,e.className=l),null!=t.attrs.className&&(e.className=t.attrs.className+" "+l)),e)if(o.call(e,f)&&"key"!==f){s=!0;break}return Array.isArray(r)&&1===r.length&&null!=r[0]&&"#"===r[0].tag?u=r[0].children:i=r,n(t.tag,e.key,s?e:void 0,i,u)}(l,u,c):n(t,u.key,u,c)}u.trust=function(t){return null==t&&(t=""),n("<",void 0,void 0,t,void 0,void 0)},u.fragment=function(t,e){return n("[",t.key,t,n.normalizeChildren(e),void 0,void 0)};var s=u;if((l=function(t){if(!(this instanceof l))throw new Error("Promise must be called with `new`");if("function"!=typeof t)throw new TypeError("executor must be a function");var e=this,n=[],r=[],i=s(n,!0),o=s(r,!1),a=e._instance={resolvers:n,rejectors:r},u="function"==typeof setImmediate?setImmediate:setTimeout;function s(t,i){return function s(l){var f;try{if(!i||null==l||"object"!=typeof l&&"function"!=typeof l||"function"!=typeof(f=l.then))u(function(){i||0!==t.length||console.error("Possible unhandled promise rejection:",l);for(var e=0;e<t.length;e++)t[e](l);n.length=0,r.length=0,a.state=i,a.retry=function(){s(l)}});else{if(l===e)throw new TypeError("Promise can't be resolved w/ itself");c(f.bind(l))}}catch(t){o(t)}}}function c(t){var e=0;function n(t){return function(n){e++>0||t(n)}}var r=n(o);try{t(n(i),r)}catch(t){r(t)}}c(t)}).prototype.then=function(t,e){var n,r,i=this._instance;function o(t,e,o,a){e.push(function(e){if("function"!=typeof t)o(e);else try{n(t(e))}catch(t){r&&r(t)}}),"function"==typeof i.retry&&a===i.state&&i.retry()}var a=new l(function(t,e){n=t,r=e});return o(t,i.resolvers,n,!0),o(e,i.rejectors,r,!1),a},l.prototype.catch=function(t){return this.then(null,t)},l.resolve=function(t){return t instanceof l?t:new l(function(e){e(t)})},l.reject=function(t){return new l(function(e,n){n(t)})},l.all=function(t){return new l(function(e,n){var r=t.length,i=0,o=[];if(0===t.length)e([]);else for(var a=0;a<t.length;a++)!function(a){function u(t){i++,o[a]=t,i===r&&e(o)}null==t[a]||"object"!=typeof t[a]&&"function"!=typeof t[a]||"function"!=typeof t[a].then?u(t[a]):t[a].then(u,n)}(a)})},l.race=function(t){return new l(function(e,n){for(var r=0;r<t.length;r++)t[r].then(e,n)})},"undefined"!=typeof window){void 0===window.Promise&&(window.Promise=l);var l=window.Promise}else if(void 0!==t){void 0===t.Promise&&(t.Promise=l);l=t.Promise}var c=function(t){if("[object Object]"!==Object.prototype.toString.call(t))return"";var e=[];for(var n in t)r(n,t[n]);return e.join("&");function r(t,n){if(Array.isArray(n))for(var i=0;i<n.length;i++)r(t+"["+i+"]",n[i]);else if("[object Object]"===Object.prototype.toString.call(n))for(var i in n)r(t+"["+i+"]",n[i]);else e.push(encodeURIComponent(t)+(null!=n&&""!==n?"="+encodeURIComponent(n):""))}},f=new RegExp("^file://","i"),h=function(t,e){var n,r=0;function i(){var t=0;function e(){0==--t&&"function"==typeof n&&n()}return function n(r){var i=r.then;return r.then=function(){t++;var o=i.apply(r,arguments);return o.then(e,function(n){if(e(),0===t)throw n}),n(o)},r}}function o(t,e){if("string"==typeof t){var n=t;null==(t=e||{}).url&&(t.url=n)}return t}function a(t,e){if(null==e)return t;for(var n=t.match(/:[^\/]+/gi)||[],r=0;r<n.length;r++){var i=n[r].slice(1);null!=e[i]&&(t=t.replace(n[r],e[i]))}return t}function u(t,e){var n=c(e);return""!==n&&(t+=(t.indexOf("?")<0?"?":"&")+n),t}function s(t){try{return""!==t?JSON.parse(t):null}catch(e){throw new Error(t)}}function l(t){return t.responseText}function h(t,e){if("function"==typeof t){if(!Array.isArray(e))return new t(e);for(var n=0;n<e.length;n++)e[n]=new t(e[n])}return e}return{request:function(n,r){var c=i();n=o(n,r);var d=new e(function(e,r){null==n.method&&(n.method="GET"),n.method=n.method.toUpperCase();var i="GET"!==n.method&&"TRACE"!==n.method&&("boolean"!=typeof n.useBody||n.useBody);"function"!=typeof n.serialize&&(n.serialize="undefined"!=typeof FormData&&n.data instanceof FormData?function(t){return t}:JSON.stringify),"function"!=typeof n.deserialize&&(n.deserialize=s),"function"!=typeof n.extract&&(n.extract=l),n.url=a(n.url,n.data),i?n.data=n.serialize(n.data):n.url=u(n.url,n.data);var o=new t.XMLHttpRequest,c=!1,d=o.abort;for(var v in o.abort=function(){c=!0,d.call(o)},o.open(n.method,n.url,"boolean"!=typeof n.async||n.async,"string"==typeof n.user?n.user:void 0,"string"==typeof n.password?n.password:void 0),n.serialize!==JSON.stringify||!i||n.headers&&n.headers.hasOwnProperty("Content-Type")||o.setRequestHeader("Content-Type","application/json; charset=utf-8"),n.deserialize!==s||n.headers&&n.headers.hasOwnProperty("Accept")||o.setRequestHeader("Accept","application/json, text/*"),n.withCredentials&&(o.withCredentials=n.withCredentials),n.headers)({}).hasOwnProperty.call(n.headers,v)&&o.setRequestHeader(v,n.headers[v]);"function"==typeof n.config&&(o=n.config(o,n)||o),o.onreadystatechange=function(){if(!c&&4===o.readyState)try{var t=n.extract!==l?n.extract(o,n):n.deserialize(n.extract(o,n));if(o.status>=200&&o.status<300||304===o.status||f.test(n.url))e(h(n.type,t));else{var i=new Error(o.responseText);for(var a in t)i[a]=t[a];r(i)}}catch(t){r(t)}},i&&null!=n.data?o.send(n.data):o.send()});return!0===n.background?d:c(d)},jsonp:function(n,s){var l=i();n=o(n,s);var c=new e(function(e,i){var o=n.callbackName||"_mithril_"+Math.round(1e16*Math.random())+"_"+r++,s=t.document.createElement("script");t[o]=function(r){s.parentNode.removeChild(s),e(h(n.type,r)),delete t[o]},s.onerror=function(){s.parentNode.removeChild(s),i(new Error("JSONP request failed")),delete t[o]},null==n.data&&(n.data={}),n.url=a(n.url,n.data),n.data[n.callbackKey||"callback"]=o,s.src=u(n.url,n.data),t.document.documentElement.appendChild(s)});return!0===n.background?c:l(c)},setCompletionCallback:function(t){n=t}}}(window,l),d=function(t){var e,r=t.document,i=r.createDocumentFragment(),o={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"};function a(t){return t.attrs&&t.attrs.xmlns||o[t.tag]}function u(t,e,n,r,i,o,a){for(var u=n;u<r;u++){var l=e[u];null!=l&&s(t,l,i,a,o)}}function s(t,e,o,f,h){var d=e.tag;if("string"!=typeof d)return function(t,e,n,r,o){if(c(e,n),null!=e.instance){var a=s(t,e.instance,n,r,o);return e.dom=e.instance.dom,e.domSize=null!=e.dom?e.instance.domSize:0,m(t,a,o),a}return e.domSize=0,i}(t,e,o,f,h);switch(e.state={},null!=e.attrs&&E(e.attrs,e,o),d){case"#":return function(t,e,n){return e.dom=r.createTextNode(e.children),m(t,e.dom,n),e.dom}(t,e,h);case"<":return l(t,e,h);case"[":return function(t,e,n,i,o){var a=r.createDocumentFragment();if(null!=e.children){var s=e.children;u(a,s,0,s.length,n,null,i)}return e.dom=a.firstChild,e.domSize=a.childNodes.length,m(t,a,o),a}(t,e,o,f,h);default:return function(t,e,i,o,s){var l=e.tag,c=e.attrs,f=c&&c.is,h=(o=a(e)||o)?f?r.createElementNS(o,l,{is:f}):r.createElementNS(o,l):f?r.createElement(l,{is:f}):r.createElement(l);e.dom=h,null!=c&&function(t,e,n){for(var r in e)b(t,r,null,e[r],n)}(e,c,o);if(m(t,h,s),null!=e.attrs&&null!=e.attrs.contenteditable)y(e);else if(null!=e.text&&(""!==e.text?h.textContent=e.text:e.children=[n("#",void 0,void 0,e.text,void 0,void 0)]),null!=e.children){var d=e.children;u(h,d,0,d.length,i,null,o),function(t){var e=t.attrs;"select"===t.tag&&null!=e&&("value"in e&&b(t,"value",null,e.value,void 0),"selectedIndex"in e&&b(t,"selectedIndex",null,e.selectedIndex,void 0))}(e)}return h}(t,e,o,f,h)}}function l(t,e,n){var i={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"}[(e.children.match(/^\s*?<(\w+)/im)||[])[1]]||"div",o=r.createElement(i);o.innerHTML=e.children,e.dom=o.firstChild,e.domSize=o.childNodes.length;for(var a,u=r.createDocumentFragment();a=o.firstChild;)u.appendChild(a);return m(t,u,n),u}function c(t,e){var r;if("function"==typeof t.tag.view){if(t.state=Object.create(t.tag),null!=(r=t.state.view).$$reentrantLock$$)return i;r.$$reentrantLock$$=!0}else{if(t.state=void 0,null!=(r=t.tag).$$reentrantLock$$)return i;r.$$reentrantLock$$=!0,t.state=null!=t.tag.prototype&&"function"==typeof t.tag.prototype.view?new t.tag(t):t.tag(t)}if(t._state=t.state,null!=t.attrs&&E(t.attrs,t,e),E(t._state,t,e),t.instance=n.normalize(t._state.view.call(t.state,t)),t.instance===t)throw Error("A view cannot return the vnode it received as argument");r.$$reentrantLock$$=null}function f(t,e,n,r,i,o,a){if(e!==n&&(null!=e||null!=n))if(null==e)u(t,n,0,n.length,i,o,a);else if(null==n)x(e,0,e.length,n);else{if(e.length===n.length){for(var l=!1,c=0;c<n.length;c++)if(null!=n[c]&&null!=e[c]){l=null==n[c].key&&null==e[c].key;break}if(l){for(c=0;c<e.length;c++)e[c]!==n[c]&&(null==e[c]&&null!=n[c]?s(t,n[c],i,a,p(e,c+1,o)):null==n[c]?x(e,c,c+1,n):h(t,e[c],n[c],i,p(e,c+1,o),r,a));return}}if(r=r||function(t,e){if(null!=t.pool&&Math.abs(t.pool.length-e.length)<=Math.abs(t.length-e.length)){var n=t[0]&&t[0].children&&t[0].children.length||0,r=t.pool[0]&&t.pool[0].children&&t.pool[0].children.length||0,i=e[0]&&e[0].children&&e[0].children.length||0;if(Math.abs(r-i)<=Math.abs(n-i))return!0}return!1}(e,n)){var f=e.pool;e=e.concat(e.pool)}for(var y,g=0,w=0,b=e.length-1,z=n.length-1;b>=g&&z>=w;){if((E=e[g])!==(k=n[w])||r)if(null==E)g++;else if(null==k)w++;else if(E.key===k.key){var _=null!=f&&g>=e.length-f.length||null==f&&r;w++,h(t,E,k,i,p(e,++g,o),_,a),r&&E.tag===k.tag&&m(t,v(E),o)}else{if((E=e[b])!==k||r)if(null==E)b--;else if(null==k)w++;else{if(E.key!==k.key)break;_=null!=f&&b>=e.length-f.length||null==f&&r;h(t,E,k,i,p(e,b+1,o),_,a),(r||w<z)&&m(t,v(E),p(e,g,o)),b--,w++}else b--,w++}else g++,w++}for(;b>=g&&z>=w;){var E,k;if((E=e[b])!==(k=n[z])||r)if(null==E)b--;else if(null==k)z--;else if(E.key===k.key){_=null!=f&&b>=e.length-f.length||null==f&&r;h(t,E,k,i,p(e,b+1,o),_,a),r&&E.tag===k.tag&&m(t,v(E),o),null!=E.dom&&(o=E.dom),b--,z--}else{if(y||(y=d(e,b)),null!=k){var A=y[k.key];if(null!=A){var S=e[A];_=null!=f&&A>=e.length-f.length||null==f&&r;h(t,S,k,i,p(e,b+1,o),r,a),m(t,v(S),o),e[A].skip=!0,null!=S.dom&&(o=S.dom)}else{o=s(t,k,i,a,o)}}z--}else b--,z--;if(z<w)break}u(t,n,w,z+1,i,o,a),x(e,g,b+1,n)}}function h(t,e,r,i,o,u,d){var p=e.tag;if(p===r.tag){if(r.state=e.state,r._state=e._state,r.events=e.events,!u&&function(t,e){var n,r;null!=t.attrs&&"function"==typeof t.attrs.onbeforeupdate&&(n=t.attrs.onbeforeupdate.call(t.state,t,e));"string"!=typeof t.tag&&"function"==typeof t._state.onbeforeupdate&&(r=t._state.onbeforeupdate.call(t.state,t,e));if(!(void 0===n&&void 0===r||n||r))return t.dom=e.dom,t.domSize=e.domSize,t.instance=e.instance,!0;return!1}(r,e))return;if("string"==typeof p)switch(null!=r.attrs&&(u?(r.state={},E(r.attrs,r,i)):k(r.attrs,r,i)),p){case"#":!function(t,e){t.children.toString()!==e.children.toString()&&(t.dom.nodeValue=e.children);e.dom=t.dom}(e,r);break;case"<":!function(t,e,n,r){e.children!==n.children?(v(e),l(t,n,r)):(n.dom=e.dom,n.domSize=e.domSize)}(t,e,r,o);break;case"[":!function(t,e,n,r,i,o,a){f(t,e.children,n.children,r,i,o,a);var u=0,s=n.children;if(n.dom=null,null!=s){for(var l=0;l<s.length;l++){var c=s[l];null!=c&&null!=c.dom&&(null==n.dom&&(n.dom=c.dom),u+=c.domSize||1)}1!==u&&(n.domSize=u)}}(t,e,r,u,i,o,d);break;default:!function(t,e,r,i,o){var u=e.dom=t.dom;o=a(e)||o,"textarea"===e.tag&&(null==e.attrs&&(e.attrs={}),null!=e.text&&(e.attrs.value=e.text,e.text=void 0));(function(t,e,n,r){if(null!=n)for(var i in n)b(t,i,e&&e[i],n[i],r);if(null!=e)for(var i in e)null!=n&&i in n||("className"===i&&(i="class"),"o"!==i[0]||"n"!==i[1]||z(i)?"key"!==i&&t.dom.removeAttribute(i):_(t,i,void 0))})(e,t.attrs,e.attrs,o),null!=e.attrs&&null!=e.attrs.contenteditable?y(e):null!=t.text&&null!=e.text&&""!==e.text?t.text.toString()!==e.text.toString()&&(t.dom.firstChild.nodeValue=e.text):(null!=t.text&&(t.children=[n("#",void 0,void 0,t.text,void 0,t.dom.firstChild)]),null!=e.text&&(e.children=[n("#",void 0,void 0,e.text,void 0,void 0)]),f(u,t.children,e.children,r,i,null,o))}(e,r,u,i,d)}else!function(t,e,r,i,o,a,u){if(a)c(r,i);else{if(r.instance=n.normalize(r._state.view.call(r.state,r)),r.instance===r)throw Error("A view cannot return the vnode it received as argument");null!=r.attrs&&k(r.attrs,r,i),k(r._state,r,i)}null!=r.instance?(null==e.instance?s(t,r.instance,i,u,o):h(t,e.instance,r.instance,i,o,a,u),r.dom=r.instance.dom,r.domSize=r.instance.domSize):null!=e.instance?(g(e.instance,null),r.dom=void 0,r.domSize=0):(r.dom=e.dom,r.domSize=e.domSize)}(t,e,r,i,o,u,d)}else g(e,null),s(t,r,i,d,o)}function d(t,e){var n={},r=0;for(r=0;r<e;r++){var i=t[r];if(null!=i){var o=i.key;null!=o&&(n[o]=r)}}return n}function v(t){var e=t.domSize;if(null!=e||null==t.dom){var n=r.createDocumentFragment();if(e>0){for(var i=t.dom;--e;)n.appendChild(i.nextSibling);n.insertBefore(i,n.firstChild)}return n}return t.dom}function p(t,e,n){for(;e<t.length;e++)if(null!=t[e]&&null!=t[e].dom)return t[e].dom;return n}function m(t,e,n){n&&n.parentNode?t.insertBefore(e,n):t.appendChild(e)}function y(t){var e=t.children;if(null!=e&&1===e.length&&"<"===e[0].tag){var n=e[0].children;t.dom.innerHTML!==n&&(t.dom.innerHTML=n)}else if(null!=t.text||null!=e&&0!==e.length)throw new Error("Child node of a contenteditable must be trusted")}function x(t,e,n,r){for(var i=e;i<n;i++){var o=t[i];null!=o&&(o.skip?o.skip=!1:g(o,r))}}function g(t,e){var n,r=1,i=0;t.attrs&&"function"==typeof t.attrs.onbeforeremove&&(null!=(n=t.attrs.onbeforeremove.call(t.state,t))&&"function"==typeof n.then&&(r++,n.then(o,o)));"string"!=typeof t.tag&&"function"==typeof t._state.onbeforeremove&&(null!=(n=t._state.onbeforeremove.call(t.state,t))&&"function"==typeof n.then&&(r++,n.then(o,o)));function o(){if(++i===r&&(function t(e){e.attrs&&"function"==typeof e.attrs.onremove&&e.attrs.onremove.call(e.state,e);if("string"!=typeof e.tag)"function"==typeof e._state.onremove&&e._state.onremove.call(e.state,e),null!=e.instance&&t(e.instance);else{var n=e.children;if(Array.isArray(n))for(var r=0;r<n.length;r++){var i=n[r];null!=i&&t(i)}}}(t),t.dom)){var n=t.domSize||1;if(n>1)for(var o=t.dom;--n;)w(o.nextSibling);w(t.dom),null==e||null!=t.domSize||null!=(a=t.attrs)&&(a.oncreate||a.onupdate||a.onbeforeremove||a.onremove)||"string"!=typeof t.tag||(e.pool?e.pool.push(t):e.pool=[t])}var a}o()}function w(t){var e=t.parentNode;null!=e&&e.removeChild(t)}function b(t,e,n,i,o){var a=t.dom;if("key"!==e&&"is"!==e&&(n!==i||function(t,e){return"value"===e||"checked"===e||"selectedIndex"===e||"selected"===e&&t.dom===r.activeElement}(t,e)||"object"==typeof i)&&void 0!==i&&!z(e)){var u,s=e.indexOf(":");if(s>-1&&"xlink"===e.substr(0,s))a.setAttributeNS("http://www.w3.org/1999/xlink",e.slice(s+1),i);else if("o"===e[0]&&"n"===e[1]&&"function"==typeof i)_(t,e,i);else if("style"===e)!function(t,e,n){e===n&&(t.style.cssText="",e=null);if(null==n)t.style.cssText="";else if("string"==typeof n)t.style.cssText=n;else{for(var r in"string"==typeof e&&(t.style.cssText=""),n)t.style[r]=n[r];if(null!=e&&"string"!=typeof e)for(var r in e)r in n||(t.style[r]="")}}(a,n,i);else if(e in a&&("href"!==(u=e)&&"list"!==u&&"form"!==u&&"width"!==u&&"height"!==u)&&void 0===o&&!function(t){return t.attrs.is||t.tag.indexOf("-")>-1}(t)){if("value"===e){var l=""+i;if(("input"===t.tag||"textarea"===t.tag)&&t.dom.value===l&&t.dom===r.activeElement)return;if("select"===t.tag)if(null===i){if(-1===t.dom.selectedIndex&&t.dom===r.activeElement)return}else if(null!==n&&t.dom.value===l&&t.dom===r.activeElement)return;if("option"===t.tag&&null!=n&&t.dom.value===l)return}if("input"===t.tag&&"type"===e)return void a.setAttribute(e,i);a[e]=i}else"boolean"==typeof i?i?a.setAttribute(e,""):a.removeAttribute(e):a.setAttribute("className"===e?"class":e,i)}}function z(t){return"oninit"===t||"oncreate"===t||"onupdate"===t||"onremove"===t||"onbeforeremove"===t||"onbeforeupdate"===t}function _(t,n,r){var i=t.dom,o="function"!=typeof e?r:function(t){var n=r.call(i,t);return e.call(i,t),n};if(n in i)i[n]="function"==typeof r?o:null;else{var a=n.slice(2);if(void 0===t.events&&(t.events={}),t.events[n]===o)return;null!=t.events[n]&&i.removeEventListener(a,t.events[n],!1),"function"==typeof r&&(t.events[n]=o,i.addEventListener(a,t.events[n],!1))}}function E(t,e,n){"function"==typeof t.oninit&&t.oninit.call(e.state,e),"function"==typeof t.oncreate&&n.push(t.oncreate.bind(e.state,e))}function k(t,e,n){"function"==typeof t.onupdate&&n.push(t.onupdate.bind(e.state,e))}return{render:function(t,e){if(!t)throw new Error("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var i=[],o=r.activeElement,a=t.namespaceURI;null==t.vnodes&&(t.textContent=""),Array.isArray(e)||(e=[e]),f(t,t.vnodes,n.normalizeChildren(e),!1,i,null,"http://www.w3.org/1999/xhtml"===a?void 0:a),t.vnodes=e,null!=o&&r.activeElement!==o&&o.focus();for(var u=0;u<i.length;u++)i[u]()},setEventCallback:function(t){return e=t}}};var v=function(t){var e=d(t);e.setEventCallback(function(t){!1===t.redraw?t.redraw=void 0:i()});var n=[];function r(t){var e=n.indexOf(t);e>-1&&n.splice(e,2)}function i(){for(var t=1;t<n.length;t+=2)n[t]()}return{subscribe:function(t,e){r(t),n.push(t,function(t){var e=0,n=null,r="function"==typeof requestAnimationFrame?requestAnimationFrame:setTimeout;return function(){var i=Date.now();0===e||i-e>=16?(e=i,t()):null===n&&(n=r(function(){n=null,t(),e=Date.now()},16-(i-e)))}}(e))},unsubscribe:r,redraw:i,render:e.render}}(window);h.setCompletionCallback(v.redraw);var p;s.mount=(p=v,function(t,e){if(null===e)return p.render(t,[]),void p.unsubscribe(t);if(null==e.view&&"function"!=typeof e)throw new Error("m.mount(element, component) expects a component, not a vnode");p.subscribe(t,function(){p.render(t,n(e))}),p.redraw()});var m=l,y=function(t){if(""===t||null==t)return{};"?"===t.charAt(0)&&(t=t.slice(1));for(var e=t.split("&"),n={},r={},i=0;i<e.length;i++){var o=e[i].split("="),a=decodeURIComponent(o[0]),u=2===o.length?decodeURIComponent(o[1]):"";"true"===u?u=!0:"false"===u&&(u=!1);var s=a.split(/\]\[?|\[/),l=n;a.indexOf("[")>-1&&s.pop();for(var c=0;c<s.length;c++){var f=s[c],h=s[c+1],d=""==h||!isNaN(parseInt(h,10)),v=c===s.length-1;if(""===f)null==r[a=s.slice(0,c).join()]&&(r[a]=0),f=r[a]++;null==l[f]&&(l[f]=v?u:d?[]:{}),l=l[f]}}return n},x=function(t){var e,n="function"==typeof t.history.pushState,r="function"==typeof setImmediate?setImmediate:setTimeout;function i(e){var n=t.location[e].replace(/(?:%[a-f89][a-f0-9])+/gim,decodeURIComponent);return"pathname"===e&&"/"!==n[0]&&(n="/"+n),n}function o(t,e,n){var r=t.indexOf("?"),i=t.indexOf("#"),o=r>-1?r:i>-1?i:t.length;if(r>-1){var a=i>-1?i:t.length,u=y(t.slice(r+1,a));for(var s in u)e[s]=u[s]}if(i>-1){var l=y(t.slice(i+1));for(var s in l)n[s]=l[s]}return t.slice(0,o)}var a={prefix:"#!",getPath:function(){switch(a.prefix.charAt(0)){case"#":return i("hash").slice(a.prefix.length);case"?":return i("search").slice(a.prefix.length)+i("hash");default:return i("pathname").slice(a.prefix.length)+i("search")+i("hash")}},setPath:function(e,r,i){var u={},s={};if(e=o(e,u,s),null!=r){for(var l in r)u[l]=r[l];e=e.replace(/:([^\/]+)/g,function(t,e){return delete u[e],r[e]})}var f=c(u);f&&(e+="?"+f);var h=c(s);if(h&&(e+="#"+h),n){var d=i?i.state:null,v=i?i.title:null;t.onpopstate(),i&&i.replace?t.history.replaceState(d,v,a.prefix+e):t.history.pushState(d,v,a.prefix+e)}else t.location.href=a.prefix+e}};return a.defineRoutes=function(i,u,s){function l(){var e=a.getPath(),n={},r=o(e,n,n),l=t.history.state;if(null!=l)for(var c in l)n[c]=l[c];for(var f in i){var h=new RegExp("^"+f.replace(/:[^\/]+?\.{3}/g,"(.*?)").replace(/:[^\/]+/g,"([^\\/]+)")+"/?$");if(h.test(r))return void r.replace(h,function(){for(var t=f.match(/:[^\/]+/g)||[],r=[].slice.call(arguments,1,-2),o=0;o<t.length;o++)n[t[o].replace(/:|\./g,"")]=decodeURIComponent(r[o]);u(i[f],n,e,f)})}s(e,n)}var c;n?t.onpopstate=(c=l,function(){null==e&&(e=r(function(){e=null,c()}))}):"#"===a.prefix.charAt(0)&&(t.onhashchange=l),l()},a};s.route=function(t,e){var r,i,o,a,u,s=x(t),l=function(t,l,c){if(null==t)throw new Error("Ensure the DOM element that was passed to `m.route` is not undefined");var f=function(){null!=r&&e.render(t,r(n(i,o.key,o)))},h=function(t){if(t===l)throw new Error("Could not resolve default route "+l);s.setPath(l,null,{replace:!0})};s.defineRoutes(c,function(t,e,n){var s=u=function(t,l){s===u&&(i=null==l||"function"!=typeof l.view&&"function"!=typeof l?"div":l,o=e,a=n,u=null,r=(t.render||function(t){return t}).bind(t),f())};t.view||"function"==typeof t?s({},t):t.onmatch?m.resolve(t.onmatch(e,n)).then(function(e){s(t,e)},h):s(t,"div")},h),e.subscribe(t,f)};return l.set=function(t,e,n){null!=u&&((n=n||{}).replace=!0),u=null,s.setPath(t,e,n)},l.get=function(){return a},l.prefix=function(t){s.prefix=t},l.link=function(t){t.dom.setAttribute("href",s.prefix+t.attrs.href),t.dom.onclick=function(t){if(!(t.ctrlKey||t.metaKey||t.shiftKey||2===t.which)){t.preventDefault(),t.redraw=!1;var e=this.getAttribute("href");0===e.indexOf(s.prefix)&&(e=e.slice(s.prefix.length)),l.set(e,void 0,void 0)}}},l.param=function(t){return void 0!==o&&void 0!==t?o[t]:o},l}(window,v),s.withAttr=function(t,e,n){return function(r){e.call(n||this,t in r.currentTarget?r.currentTarget[t]:r.currentTarget.getAttribute(t))}};var g=d(window);s.render=g.render,s.redraw=v.redraw,s.request=h.request,s.jsonp=h.jsonp,s.parseQueryString=y,s.buildQueryString=c,s.version="1.1.6",s.vnode=n,void 0!==e?e.exports=s:window.m=s}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[4]);
